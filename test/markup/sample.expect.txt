<span class="hljs-keyword">rule</span> CISA_3P_10301706_01 : HiddenCobra ECCENTRICBANDWAGON backdoor keylogger reconnaissance screencapture spyware trojan   
   {   
      <span class="hljs-keyword">meta</span>:   
          Author <span class="hljs-operator">=</span> <span class="hljs-string">&quot;CISA Trusted Third Party&quot;</span>   
          Incident <span class="hljs-operator">=</span> <span class="hljs-string">&quot;10301706.r1.v1&quot;</span>   
          Date <span class="hljs-operator">=</span> <span class="hljs-string">&quot;2020-08-11&quot;</span>   
          Actor <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hidden Cobra&quot;</span>   
          Category <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Backdoor Keylogger Reconnaissance Screen-Capture Spyware Trojan&quot;</span>   
          Family <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ECCENTRICBANDWAGON&quot;</span>   
          Description <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Detects strings in ECCENTRICBANDWAGON proxy tool&quot;</span>   
          MD5_1 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;d45931632ed9e11476325189ccb6b530&quot;</span>   
          SHA256_1 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;efd470cfa90b918e5d558e5c8c3821343af06eedfd484dfeb20c4605f9bdc30e&quot;</span>   
          MD5_2 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;acd15f4393e96fe5eb920727dc083aed&quot;</span>   
          SHA256_2 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;32a4de070ca005d35a88503717157b0dc3f2e8da76ffd618fca6563aec9c81f8&quot;</span>   
          MD5_3 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;34404a3fb9804977c6ab86cb991fb130&quot;</span>   
          SHA256_3 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec&quot;</span>   
          MD5_4 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;3122b0130f5135b6f76fca99609d5cbe&quot;</span>   
          SHA256_4 <span class="hljs-operator">=</span> <span class="hljs-string">&quot;9ea5aa00e0a738b74066c61b1d35331170a9e0a84df1cc6cef58fd46a8ec5a2e&quot;</span>   
      <span class="hljs-keyword">strings</span>:   
          <span class="hljs-variable">$sn1</span> <span class="hljs-operator">=</span> { <span class="hljs-number">FB</span> <span class="hljs-number">19</span> <span class="hljs-number">9D</span> <span class="hljs-number">57</span> [<span class="hljs-number">1</span><span class="hljs-number">-6</span>] <span class="hljs-number">9A</span> <span class="hljs-number">D1</span> <span class="hljs-number">D6</span> <span class="hljs-number">D1</span> [<span class="hljs-number">1</span><span class="hljs-number">-6</span>] <span class="hljs-number">42</span> <span class="hljs-number">9E</span> <span class="hljs-number">D8</span> <span class="hljs-number">FD</span> }   
          <span class="hljs-variable">$sn2</span> <span class="hljs-operator">=</span> { <span class="hljs-number">4F</span> <span class="hljs-number">03</span> <span class="hljs-number">43</span> <span class="hljs-number">83</span> [<span class="hljs-number">1</span><span class="hljs-number">-6</span>] <span class="hljs-number">48</span> <span class="hljs-number">E0</span> <span class="hljs-number">1A</span> <span class="hljs-number">2E</span> [<span class="hljs-number">1</span><span class="hljs-number">-6</span>] <span class="hljs-number">3B</span> <span class="hljs-number">FD</span> <span class="hljs-number">FD</span> <span class="hljs-number">FD</span> }   
          <span class="hljs-variable">$sn3</span> <span class="hljs-operator">=</span> { <span class="hljs-number">68</span> <span class="hljs-number">56</span> <span class="hljs-number">68</span> <span class="hljs-number">9A</span> [<span class="hljs-number">1</span><span class="hljs-number">-12</span>] <span class="hljs-number">4D</span> <span class="hljs-number">E1</span> <span class="hljs-number">1F</span> <span class="hljs-number">25</span> [<span class="hljs-number">1</span><span class="hljs-number">-12</span>] <span class="hljs-number">3F</span> <span class="hljs-number">38</span> <span class="hljs-number">54</span> <span class="hljs-number">0F</span> [<span class="hljs-number">1</span><span class="hljs-number">-12</span>] <span class="hljs-number">73</span> <span class="hljs-number">30</span> <span class="hljs-number">62</span> <span class="hljs-number">A1</span> [<span class="hljs-number">1</span><span class="hljs-number">-12</span>] <span class="hljs-number">DB</span> <span class="hljs-number">39</span> <span class="hljs-number">BD</span> <span class="hljs-number">56</span> }   
          <span class="hljs-variable">$sn4</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;%s\\chromeupdater_ps_%04d%02d%02d_%02d%02d%02d_%03d_%d&quot;</span> <span class="hljs-keyword">wide</span> <span class="hljs-keyword">ascii</span> <span class="hljs-keyword">nocase</span>   
          <span class="hljs-variable">$sn5</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;c:\\windows\\temp\\TMP0389A.tmp&quot;</span> <span class="hljs-keyword">wide</span> <span class="hljs-keyword">ascii</span> <span class="hljs-keyword">nocase</span>   
      <span class="hljs-keyword">condition</span>:   
          <span class="hljs-keyword">any</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">them</span>   
   }
